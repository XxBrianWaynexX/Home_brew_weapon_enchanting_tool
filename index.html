<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homebrew Weapon Enchanting Tool</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    select, input, button {
      margin: 10px 0;
      padding: 8px;
      width: 100%;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .failure {
      color: red;
      font-weight: bold;
    }
    .failure-effect, .quirk {
      color: darkred;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Homebrew Weapon Enchanting Tool</h1>

    <!-- Weapon Selection -->
    <label for="weapon">Select a Weapon Type:</label>
    <select id="weapon">
      <option value="">-- Select a Weapon --</option>
      <option value="Longsword">Longsword</option>
      <option value="Dagger">Dagger</option>
      <option value="Greatsword">Greatsword</option>
      <option value="Bow">Bow</option>
      <option value="Custom">Custom (Enter Below)</option>
    </select>
    <input type="text" id="customWeapon" placeholder="Enter custom weapon name" style="display:none;">

    <!-- Enchantment Properties -->
    <label for="attackBonus">Select Attack Bonus:</label>
    <select id="attackBonus">
      <option value="">-- No Bonus --</option>
      <option value="+1">+1</option>
      <option value="+2">+2</option>
      <option value="+3">+3</option>
    </select>

    <label for="damageType">Select Damage Type:</label>
    <select id="damageType">
      <option value="">-- Select Damage Type --</option>
      <option value="Fire">Fire</option>
      <option value="Radiant">Radiant</option>
      <option value="Necrotic">Necrotic</option>
      <option value="Cold">Cold</option>
      <option value="Lightning">Lightning</option>
      <option value="Force">Force</option>
    </select>

    <label for="specialEffects">Select Special Effects:</label>
    <select id="specialEffects" multiple>
      <option value="Foe Slayer">Foe Slayer (extra damage to specific creatures)</option>
      <option value="Detect Alignment">Detect Good/Evil or specific creatures</option>
      <option value="Flight">Grants limited flight</option>
      <option value="Combat Clairvoyance">Combat Clairvoyance (advantage for 1 round)</option>
      <option value="Vorpal">Vorpal (critical hits can decapitate)</option>
      <option value="Sharpness">Sharpness (doubles crit range)</option>
      <option value="Anarchic">Anarchic (extra damage to lawful creatures)</option>
      <option value="Axiomatic">Axiomatic (extra damage to chaotic creatures)</option>
      <option value="Brilliant Energy">Brilliant Energy (ignores non-living armor)</option>
      <option value="Dancing">Dancing weapon (fights independently)</option>
      <option value="Defending">Defending (bonus to AC)</option>
      <option value="Disruption">Disruption (destroys undead)</option>
      <option value="Flaming Burst">Flaming Burst (extra fire damage on crits)</option>
      <option value="Ghost Touch">Ghost Touch (affects incorporeal creatures)</option>
      <option value="Holy">Holy (extra damage to evil creatures)</option>
      <option value="Icy Burst">Icy Burst (extra cold damage on crits)</option>
      <option value="Keen">Keen (doubles crit range)</option>
      <option value="Ki Focus">Ki Focus (enhances ki abilities)</option>
      <option value="Seeking">Seeking (ranged, ignores cover)</option>
      <option value="Shock">Shock (deals lightning damage)</option>
      <option value="Shocking Burst">Shocking Burst (extra lightning damage on crits)</option>
      <option value="Speed">Speed (extra attack per turn)</option>
      <option value="Spell Storing">Spell Storing (stores one spell)</option>
      <option value="Unholy">Unholy (extra damage to good creatures)</option>
      <option value="Vicious">Vicious (extra damage, harms wielder)</option>
      <option value="Wounding">Wounding (prevents healing)</option>
    </select>

    <!-- Material Requirements -->
    <h2>Required Materials</h2>
    <div id="materials"></div>

    <!-- Risk Roll -->
    <label for="classLevel">Enter Class Level:</label>
    <input type="number" id="classLevel" placeholder="Enter your class level" min="1" max="20">

    <label for="proficiencyBonus">Enter Proficiency Bonus:</label>
    <input type="number" id="proficiencyBonus" placeholder="Enter proficiency bonus" min="0">

    <button onclick="generateEnchantingDetails()">Generate Enchanting Details</button>
    <div id="enchantingDetails"></div>
    <button id="rollButton" style="display:none;" onclick="rollOutcome()">Attempt Enchantment</button>
    <div id="enchantmentResults"></div>
  </div>

  <script>
    // Material requirements for enchantments
    const enchantmentMaterials = {
      "+1": { materials: "Magical Iron Ingot", cost: 100 },
      "+2": { materials: "Refined Mithril", cost: 500 },
      "+3": { materials: "Adamantine Shard", cost: 1500 },
      "Fire": { materials: "Fire Essence", cost: 300 },
      "Radiant": { materials: "Radiant Crystal", cost: 400 },
      "Necrotic": { materials: "Shadow Shard", cost: 350 },
      "Cold": { materials: "Frost Core", cost: 300 },
      "Lightning": { materials: "Storm Orb", cost: 350 },
      "Force": { materials: "Arcane Residuum", cost: 500 },
      "Foe Slayer": { materials: "Dragon Tooth", cost: 500 },
      "Detect Alignment": { materials: "Holy Symbol", cost: 200 },
      "Flight": { materials: "Feather of a Roc", cost: 700 },
      "Combat Clairvoyance": { materials: "Foresight Crystal", cost: 400 },
      "Vorpal": { materials: "Vorpal Shard", cost: 2000 },
      "Sharpness": { materials: "Obsidian Edge", cost: 1200 },
      "Anarchic": { materials: "Chaotic Residuum", cost: 500 },
      "Axiomatic": { materials: "Lawful Rune", cost: 500 },
      "Brilliant Energy": { materials: "Radiant Core", cost: 1500 },
      "Dancing": { materials: "Animated Core", cost: 1000 },
      "Defending": { materials: "Runed Steel", cost: 600 },
      "Disruption": { materials: "Holy Water Vial", cost: 400 },
      "Flaming Burst": { materials: "Ignis Shard", cost: 700 },
      "Ghost Touch": { materials: "Spectral Essence", cost: 400 },
      "Holy": { materials: "Celestial Core", cost: 800 },
      "Icy Burst": { materials: "Frost Core", cost: 700 },
      "Keen": { materials: "Razor Gem", cost: 500 },
      "Ki Focus": { materials: "Monk's Crystal", cost: 300 },
      "Seeking": { materials: "Seeker's Shard", cost: 400 },
      "Shock": { materials: "Lightning Residuum", cost: 300 },
      "Shocking Burst": { materials: "Storm Essence", cost: 700 },
      "Speed": { materials: "Quicksilver Essence", cost: 900 },
      "Spell Storing": { materials: "Arcane Orb", cost: 600 },
      "Unholy": { materials: "Infernal Rune", cost: 800 },
      "Vicious": { materials: "Cursed Steel", cost: 400 },
      "Wounding": { materials: "Bloodstone", cost: 500 }
    };

    // Failure effects and quirks
    const failureEffects = [
      "The weapon is destroyed in the process.",
      "The enchantment fails, and the materials are consumed.",
      "The weapon is cursed, inflicting harm on its wielder.",
      "An explosion deals 2d6 fire damage to everyone nearby.",
      "A minor rift summons a hostile elemental spirit."
    ];
    const quirks = [
      "The weapon hums when held.",
      "The weapon emits faint light intermittently.",
      "The weapon becomes slightly heavier.",
      "The weapon whispers faintly to the wielder.",
      "The weapon is cold to the touch."
    ];

    // Generate enchanting details
    function generateEnchantingDetails() {
      const weapon = document.getElementById("weapon").value;
      const customWeapon = document.getElementById("customWeapon").value;
      const attackBonus = document.getElementById("attackBonus").value;
      const damageType = document.getElementById("damageType").value;
      const specialEffects = Array.from(document.getElementById("specialEffects").selectedOptions).map(opt => opt.value);
      const classLevel = parseInt(document.getElementById("classLevel").value);
      const proficiencyBonus = parseInt(document.getElementById("proficiencyBonus").value);

      if ((!weapon && !customWeapon) || isNaN(classLevel) || isNaN(proficiencyBonus)) {
        alert("Please fill out all required fields.");
        return;
      }

      // Calculate material costs
      let requiredMaterials = [];
      let totalCost = 0;

      if (attackBonus) {
        requiredMaterials.push(`${enchantmentMaterials[attackBonus].materials} (${enchantmentMaterials[attackBonus].cost} gp)`);
        totalCost += enchantmentMaterials[attackBonus].cost;
      }
      if (damageType) {
        requiredMaterials.push(`${enchantmentMaterials[damageType].materials} (${enchantmentMaterials[damageType].cost} gp)`);
        totalCost += enchantmentMaterials[damageType].cost;
      }
      specialEffects.forEach(effect => {
        requiredMaterials.push(`${enchantmentMaterials[effect].materials} (${enchantmentMaterials[effect].cost} gp)`);
        totalCost += enchantmentMaterials[effect].cost;
      });

      // Display materials and enchanting details
      document.getElementById("materials").innerHTML = `
        <p><strong>Materials Needed:</strong></p>
        <ul>${requiredMaterials.map(material => `<li>${material}</li>`).join("")}</ul>
        <p><strong>Total Cost:</strong> ${totalCost} gp</p>
      `;

      document.getElementById("enchantingDetails").innerHTML = `
        <h2>Enchanting Details</h2>
        <p><strong>Weapon:</strong> ${customWeapon || weapon}</p>
        <p><strong>Attack Bonus:</strong> ${attackBonus || "None"}</p>
        <p><strong>Damage Type:</strong> ${damageType || "None"}</p>
        <p><strong>Special Effects:</strong> ${specialEffects.join(", ") || "None"}</p>
      `;

      document.getElementById("rollButton").style.display = "block";
    }

    // Roll for outcome
    function rollOutcome() {
      const classLevel = parseInt(document.getElementById("classLevel").value);
      const proficiencyBonus = parseInt(document.getElementById("proficiencyBonus").value);
      const weapon = document.getElementById("weapon").value || document.getElementById("customWeapon").value;
      const baseDC = 10;
      const attackBonus = document.getElementById("attackBonus").value ? parseInt(document.getElementById("attackBonus").value.replace("+", "")) * 5 : 0;
      const damageType = document.getElementById("damageType").value ? 5 : 0;
      const specialEffects = Array.from(document.getElementById("specialEffects").selectedOptions).length * 5;
      const craftingDC = baseDC + attackBonus + damageType + specialEffects;

      const roll = Math.floor(Math.random() * 20) + 1;
      const totalRoll = roll + classLevel + proficiencyBonus;

      let resultMessage = "";
      if (totalRoll >= craftingDC) {
        resultMessage = `<h2 class="success">Success!</h2><p>You successfully enchanted the ${weapon}!</p>`;
      } else if (totalRoll >= craftingDC - 5) {
        const quirk = quirks[Math.floor(Math.random() * quirks.length)];
        resultMessage = `
          <h2 class="success">Partial Success!</h2>
          <p>The enchantment worked, but the weapon gained a quirk: <span class="quirk">${quirk}</span>.</p>
        `;
      } else {
        const failureEffect = failureEffects[Math.floor(Math.random() * failureEffects.length)];
        resultMessage = `
          <h2 class="failure">Failure!</h2>
          <p>The enchantment failed.</p>
          <p class="failure-effect">Effect: ${failureEffect}</p>
        `;
      }

      document.getElementById("enchantmentResults").innerHTML = resultMessage;
    }
  </script>
</body>
</html>
